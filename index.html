<script>
  // 4가지 색상
  const COLORS = [
    { name: "블랙",    code: "#000000" },
    { name: "진그레이", code: "#333333" },
    { name: "메탈",    code: "#8e8e8e" },
    { name: "연블루",   code: "#87a6d8" }
  ];

  // 부위와 SVG 클래스 매핑
  const PARTS = {
    topMain:    ".st7",
    topSub:     ".st8",
    connector:  ".st9",
    arm:        ".st6",
    armBand:    ".st10",
    hood:       ".st12",
    bottomMain: ".st5"
  };

  // 버튼 UI 자동 생성
  function makeButtons(partId) {
    const wrap = document.getElementById(partId);
    COLORS.forEach(c => {
      const btn = document.createElement("button");
      btn.className = "color-btn";
      btn.dataset.target = partId;
      btn.dataset.color = c.code;
      btn.innerHTML =
        `<span class="color-swatch" style="background:${c.code}"></span>${c.name}`;
      wrap.appendChild(btn);
    });
  }

  Object.keys(PARTS).forEach(id => makeButtons(id));

  // SVG 문서 가져오기
  function getSvgDoc() {
    const obj = document.getElementById("wetsuitSvg");
    if (!obj) return null;

    if (obj.contentDocument) return obj.contentDocument;
    if (obj.getSVGDocument) return obj.getSVGDocument();  // 함수 호출 O

    return null;
  }

  function initSvgInteraction() {
    const svgDoc = getSvgDoc();
    if (!svgDoc) {
      console.warn("SVG 문서를 아직 못 찾았어요.");
      return;
    }

    const buttons = document.querySelectorAll(".color-btn");

    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        const part = btn.dataset.target;
        const color = btn.dataset.color;
        const selector = PARTS[part];
        const nodes = svgDoc.querySelectorAll(selector);

        // ⚠️ setAttribute → style.fill (CSS보다 우선순위 높음)
        nodes.forEach(el => {
          el.style.fill = color;
        });
      });
    });
  }

  // 페이지 / SVG 로드 모두 대비
  window.addEventListener("load", () => {
    const obj = document.getElementById("wetsuitSvg");

    initSvgInteraction(); // 이미 로드된 경우 대비
    if (obj) obj.addEventListener("load", initSvgInteraction); // 아직이면 후처리
  });
</script>

</html>
<object id="wetsuitSvg" type="image/svg+xml" data="wetsuit.svg"></object>
